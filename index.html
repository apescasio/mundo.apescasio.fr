<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Insignificant Traveler.</title>

  <!-- Open Graph / Social Media Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Insignificant Traveler.">
  <meta property="og:description" content="@himapescasio - 9/195.">
  <meta property="og:site_name" content="mundo.apescasio.fr">
  <meta property="og:url" content="http://mundo.apescasio.fr">
  <meta property="og:image" content="http://mundo.apescasio.fr/icon.png">
  <meta property="og:image:alt" content="Insignificant Traveler.">
  <meta property="og:image:width" content="512">
  <meta property="og:image:height" content="512">

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Insignificant Traveler.">
  <meta name="twitter:description" content="@himapescasio - 9/195.">
  <meta name="twitter:image"
    content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiI+PHJlY3Qgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiIGZpbGw9IiMxYTFhMWEiLz48cGF0aCBmaWxsPSJ3aGl0ZSIgZD0ibTIzMy45ODYgODUuMjYybC02My4zNyAyMS4xMUwzMzQuMzIgMTYwLjlsNjMuMzczLTIxLjExbC0xNjMuNzA3LTU0LjUzem0tODIuODUgMzMuNTkzdjU4LjA4OGwxNzQuMTg0IDU4LjAydi01OC4wODZsLTE3NC4xODMtNTguMDIyem0tMTggNTAuMjE1bC01My43MSAxNy44OWwxNjIuNjMgNTQuMTc1bDIyLjQxNy03LjQ2N2wtMTI1LjE4LTQxLjdhOSA5IDAgMCAxLTYuMTU2LTguNTM2em0tNzMuMTkgMzAuMzc1djU4LjA4OGwxMjIuMjg2IDQwLjczM3YtMzAuNzFhOSA5IDAgMCAxIC4wMTgtLjM1N2wuMDEtLjE5MmE5IDkgMCAwIDEgLjA3LS42OTdsLjAzLS4yMDVhOSA5IDAgMCAxIC4xMzQtLjY2bC4wNi0uMjM2YTkgOSAwIDAgMSAuMTktLjYxNmwuMDkyLS4yNDhhOSA5IDAgMCAxIC4yMzgtLjU2N2E5IDkgMCAwIDEgLjEzNS0uMjgyYTkgOSAwIDAgMSAuMjY1LS40ODhhOSA5IDAgMCAxIC4xOTctLjMyYTkgOSAwIDAgMSAuMjgtLjQxYTkgOSAwIDAgMSAuMjYtLjM0MmE5IDkgMCAwIDEgLjI88LS4zNDRhOSA5IDAgMCAxIC4zMTgtLjM0MmE5IDkgMCAwIDEgLjMtLjI5YTkgOSAwIDAgMSAuMzc0LS4zM2E5IDkgMCAwIDEgLjMtLjIzN2E5IDkgMCAwIDEgLjQzOC0uMzE1YTkgOSAwIDAgMSAuMjg2LS4xODJhOSA5IDAgMCAxIC41MDItLjI5YTkgOSAwIDAgMSAuMjYtLjEzM2E5IDkgMCAwIDEgLjU5LS4yNjJsLjIxLS4wODJhOSA5IDAgMCAxIC4zMTctLjEyMmwyNS4xOC04LjM4N3ptMzY0Ljg0NyAyNy4zNTJsLTg3LjYzIDI5LjE5bC0uMjQ3LjA3YTkgOSAwIDAgMS0uMzU1LjFhOSA5IDAgMCAxLS40NDMuMWE5IDkgMCAwIDEtLjQ3LjA4NWE5IDkgMCAwIDEtLjQuMDVhOSA5IDAgMCAxLS40OS4wMzhhOSA5IDAgMCAxLS40MjMuMDA3YTkgOSAwIDAgMS0uNDgtLjAxYTkgOSAwIDAgMS0uMzk3LS4wM2E5IDkgMCAwIDEtLjUwNC0uMDZhOSA5IDAgMCAxLS4zOC0uMDdhOSA5IDAgMCAxLS41Mi0uMTE3YTkgOSAwIDAgMS0uMzEtLjA4N2E5IDkgMCAwIDEtLjI2OC0uMDc3bC0zOC41MjYtMTIuODM0bC03My4yMyAyNC4zOTVsNjMuMzY4IDIxLjExbDE2My43MDctNTQuNTMyem0tMjI0LjU2IDUzLjI0MnY1OC4wODVsNzMuODUgMjQuNjAydi0zNi4yMjVsLjAwNS4wMDJWMzA0LjYzbC0yLjc1Mi0uOTE1bC0uMDE0LjAwNGwtNzEuMDktMjMuNjh6bS04NS4xNzQgMTQuODJMNTguNTcgMzEzLjY4bDYzLjM3MyAyMS4xMWw1Ni40ODUtMTguODE3bC02My4zNy0yMS4xMXpNMzkuMDk1IDMyNi4xN3Y1OC4wODhsNzMuODUgMjQuNlYzNTAuNzd6bTM5MC4yMDcgOS44MTZsLTYzLjM3NSAyMS4xMTJsMzYuMjgzIDEyLjA4Nmw2My4zNzQtMjEuMTEybC0zNi4yOC0xMi4wODZ6TTIxOS4wMyAzNjMuMzZ2MjEuODZsMTc0LjE4MyA1OC4wMjJ2LTU4LjA4OEwzMzcuNDUgMzY2LjU4bC01MS41MTYgMTcuMTYybC0uMTkuMDUzYTkgOSAwIDAgMS0uNDY3LjEzM2E5IDkgMCAwIDEtLjMzMi4wNzRhOSA5IDAgMCAxLS41ODguMTA3bC0uMjUzLjAzYTkgOSAwIDAgMS0uNjc0LjA1M2wtLjE5Ni4wMDRhOSA5IDAgMCAxLS42OTMtLjAxM2wtLjIwNi0uMDE2YTkgOSAwIDAgMS0uNzIzLS4wOWwtLjEyMi0uMDJhOSA5IDAgMCAxLS43OTUtLjE4bC0uMDI1LS4wMDdhOSA5IDAgMCAxLS40MzItLjEyMmwtNjEuMjA3LTIwLjM5eiIvPjwvc3ZnPg==">

  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #1a1a1a;
      color: #e5e7eb;
      font-family: 'Arial', sans-serif;
      overflow: hidden;
    }

    #globe {
      width: min(92vmin, 900px);
      height: min(92vmin, 700px);
      max-height: 150vh;
      display: block;
      background: transparent;
      margin-top: -5px;
    }

    svg#globe {
      /* Mobile first: 400x400px */
      width: 400px;
      height: 400px;
      display: block;
      background: transparent;
      margin-top: -55px;
    }

    footer {
      margin-top: -40px !important;
    }

    /* Larger screens: 660x620px */
    @media (min-width: 1024px) {
      svg#globe {
        width: 660px;
        height: 620px;
        margin-top: -85px;
      }

      footer {
        margin-top: -65px !important;
      }
    }

    /* Globe visuals */
    .sphere {
      fill: #0b2233;
    }

    /* ocean color inside the sphere */

    /* Non-clickable countries (muted, no pointer events) */
    .country {
      stroke: #2a5575;
      stroke-width: 0.4px;
      fill: #123247;
      cursor: default;
      pointer-events: none;
    }

    /* Clickable countries (highlight + pointer) */
    .country.active {
      fill: #1e84d0;
      stroke: #66b2ff;
      pointer-events: all;
      cursor: pointer;
    }

    .country.active:hover {
      fill: #ffd666;
    }

    .country.active:focus {
      outline: none;
      stroke: #ff9800;
      stroke-width: 1px;
    }
  </style>
</head>

<body class="flex flex-col items-center p-4">
  <header class="text-center mb-2">
    <div class="flex justify-center mb-4">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 20 20"
        class="text-white"><!-- Icon from Fluent UI System Icons by Microsoft Corporation - https://github.com/microsoft/fluentui-system-icons/blob/main/LICENSE -->
        <path fill="currentColor"
          d="M11.313 17.893q-.642.106-1.313.107a8 8 0 1 1 7.993-7.669a3 3 0 0 0-1.02-.945A7 7 0 0 0 16.54 7.5h-2.733c.097.608.16 1.247.183 1.907c-.4.233-.74.556-.994.94Q13 10.175 13 10c0-.883-.073-1.725-.206-2.5H7.206A15 15 0 0 0 7 10c0 .883.073 1.725.206 2.5h5.335c.06.359.185.696.36 1H7.42c.153.59.342 1.126.56 1.592C8.592 16.41 9.342 17 10 17c.32 0 .663-.14 1-.437c.01.453.11.907.313 1.33m.709-12.985C11.407 3.59 10.657 3 10 3s-1.407.59-2.022 1.908A9.3 9.3 0 0 0 7.42 6.5h5.162a9.3 9.3 0 0 0-.56-1.592M6.389 6.5c.176-.743.407-1.422.683-2.015c.186-.399.401-.773.642-1.103A7.02 7.02 0 0 0 3.936 6.5zM6 10c0-.87.067-1.712.193-2.5H3.46A7 7 0 0 0 3 10c0 .88.163 1.724.46 2.5h2.733A16 16 0 0 1 6 10m1.072 5.515a10.5 10.5 0 0 1-.683-2.015H3.936a7.02 7.02 0 0 0 3.778 3.118a6.6 6.6 0 0 1-.642-1.103M16.064 6.5a7.02 7.02 0 0 0-3.778-3.118c.241.33.456.704.642 1.103c.276.593.507 1.272.683 2.015zM17.5 12a2 2 0 1 1-4 0a2 2 0 0 1 4 0m1.5 4.5c0 1.245-1 2.5-3.5 2.5S12 17.75 12 16.5a1.5 1.5 0 0 1 1.5-1.5h4a1.5 1.5 0 0 1 1.5 1.5" />
      </svg>
    </div>
    <h1 class="text-4xl font-bold text-white mb-2">Insignificant Traveler.</h1>
      <p class="text-lg text-gray-400"><a href="https://twitter.com/@himapescasio">Twitter: @himapescasio (3/195).</a>
      </p>
  </header>

  <div class="flex justify-center">
    <svg id="globe" viewBox="0 0 700 700" aria-hidden="true"></svg>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js"></script>
  <script>
    (async function () {
      // Edit this list to control which countries are clickable
      const CLICKABLE = new Set([
        'philippines',
        'vietnam',
        'thailand',
      ]);

      const width = 700, height = 700;
      const svg = d3.select('#globe');
      const g = svg.append('g');

      // Orthographic globe
      const projection = d3.geoOrthographic()
        .scale((Math.min(width, height) / 2) - 8)
        .translate([width / 2, height / 2])
        .clipAngle(90);

      // Initial zoom configuration (first visit gets a default zoom-out)
      const MIN_SCALE = 80;
      const MAX_SCALE = (Math.min(width, height) / 2) * 2;
      const BASE_SCALE = (Math.min(width, height) / 2) - 8;
      const storedScale = parseFloat(localStorage.getItem('globeScale'));
      let initialScale = Number.isFinite(storedScale) ? storedScale : BASE_SCALE * 0.75; // tweak 0.85 to your taste
      initialScale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, initialScale));
      projection.scale(initialScale).rotate([0, 0]);

      const path = d3.geoPath(projection);

      // Sphere (ocean)
      const sphere = g.append('path').attr('class', 'sphere').attr('d', path({ type: 'Sphere' }));

      // GeoJSON (countries with properties.name)
      const world = await d3.json('https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson');

      const countries = g.selectAll('path.country')
        .data(world.features)
        .join('path')
        .attr('class', d => `country ${isClickable(d.properties.name) ? 'active' : ''}`)
        .attr('d', path);

      // Only attach events and keyboard focus to clickable countries
      const active = countries.filter(d => isClickable(d.properties.name));
      active
        .attr('tabindex', 0)
        .on('click', (event, d) => openLinkFor(d.properties.name))
        .on('keydown', (event, d) => {
          if (event.key === 'Enter' || event.key === ' ') openLinkFor(d.properties.name);
        });

      function isClickable(name) {
        return CLICKABLE.has(normalizeName(name));
      }

      function normalizeName(name) {
        return name
          .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // strip accents
          .toLowerCase()
          .trim();
      }

      // Map specific countries to external links.
      const LINKS = {
        // Replace the value below with your actual Twitter post URL
        philippines: 'https://twitter.com/@himapescasio',
        vietnam: 'https://twitter.com/@himapescasio',
        thailand: 'https://twitter.com/@himapescasio',
        // France: no link on purpose for now => it's clickable but does nothing
      };

      function openLinkFor(name) {
        const key = normalizeName(name);
        const url = LINKS[key];
        if (url) {
          window.open(url, '_blank', 'noopener');
        }
        // If no URL, do nothing (keeps it clickable with no action)
      }

      // Drag to rotate
      let r0, start;
      svg.call(
        d3.drag()
          .on('start', (event) => {
            r0 = projection.rotate();
            start = [event.x, event.y];
          })
          .on('drag', (event) => {
            const dx = event.x - start[0];
            const dy = event.y - start[1];
            const λ = r0[0] + (dx / width) * 360;
            const φ = r0[1] - (dy / height) * 180;
            projection.rotate([λ, Math.max(-90, Math.min(90, φ)), r0[2] || 0]);
            render();
          })
      );

      // Removed wheel zoom handler: globe size is now fixed by CSS

      function render() {
        sphere.attr('d', path({ type: 'Sphere' }));
        countries.attr('d', path);
      }
    })();
  </script>


  <footer class="mt-12 text-center text-gray-500">
    <p>Hosted at <a href="https://github.com/apescasio" class="hover:text-blue-400 underline">mundo.apescasio.fr</a></p>
    <p class="text-center text-sm lg:text-base">
      &copy; <span id="current-year"></span> Aaron (Iso) Pescasio /
      <a href="https://apescasio.fr/" target="_blank" class="hover:text-blue-400 underline">
        apescasio.fr
      </a>
    </p>
  </footer>

  <script>
    document.getElementById('current-year').textContent = new Date().getFullYear();

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });
  </script>